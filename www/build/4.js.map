{"version":3,"sources":["../../src/pages/cart/cart.module.ts","../../src/pages/cart/cart.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { CartPage } from './cart';\n\n@NgModule({\n  declarations: [\n    CartPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(CartPage),\n  ],\n})\nexport class CartPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/cart/cart.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, AlertController, ViewController } from 'ionic-angular';\nimport { Storage } from '@ionic/storage';\nimport { LoadingProvider } from '../../providers/loading';\nimport { FirebaseProvider } from '../../providers/firebase';\n\n@IonicPage()\n@Component({\n  selector: 'page-cart',\n  templateUrl: 'cart.html',\n})\nexport class CartPage {\n\n  cart = [];\n  modal = false;\n  amount = 0;\n  user;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private storage: Storage,\n    public alertCtrl: AlertController,\n    private viewCtrl: ViewController,\n    private loadingProvider: LoadingProvider,\n    private firebaseProvider: FirebaseProvider\n  ) {\n    this.getCartData();\n    this.getCurrentUser();\n    this.modal = this.navParams.get('modal');\n  }\n\n  //Refresh page\n  refresh(refresher) {\n    refresher.complete();\n    this.navCtrl.setRoot(this.navCtrl.getActive().component);\n  }\n\n  //Close modal\n  close() {\n    this.viewCtrl.dismiss()\n  }\n\n  //Get products added on cart\n  getCartData() {\n    this.storage.get('cart_pizza_app')\n      .then((res) => {\n        if (res) {\n          this.cart = res;\n          this.updateAmount();\n        }\n      })\n  }\n\n  //Update amount\n  updateAmount() {\n    //Amount\n    let i = 0;\n    for (i; i < this.cart.length; i++) {\n      let price = parseFloat(this.cart[i].price);\n      this.amount = this.amount + price;\n    }\n  }\n\n  //Convert to price format\n  toPrice(price) {\n    price = parseFloat(price);\n    return price.toFixed(2);\n  }\n\n  //Remove item from cart\n  removeItem(i, item) {\n    let index = i;\n    this.cart.splice(index, 1);\n    // Update cart on storage\n    this.storage.set('cart_pizza_app', this.cart)\n      .then((res) => {\n        let alert = this.alertCtrl.create({\n          title: 'Sucesso',\n          subTitle: 'Item removido do seu carrinho com sucesso!',\n          buttons: ['Ok']\n        });\n        alert.present();\n        this.updateAmount();\n      })\n  }\n\n  //Get current user data\n  getCurrentUser() {\n    this.storage.get('user_pizza_app')\n      .then((user) => {\n        this.user = user;\n      })\n  }\n\n  //Pay and create order\n  pay() {\n    const prompt = this.alertCtrl.create({\n      title: 'Finalizar',\n      message: \"Total: R$\" + this.toPrice(this.amount),\n      buttons: [\n        {\n          text: 'Cancelar',\n          handler: data => {\n          }\n        },\n        {\n          text: 'Efetuar pedido',\n          handler: data => {\n            //Crate order on firestore\n            this.loadingProvider.present();\n            let order = {\n              items: this.cart,\n              total: this.amount,\n              from: this.user.uid\n            }\n            this.firebaseProvider.postOrder(order)\n              .then((res) => {\n                this.loadingProvider.dismiss();\n                //Clear storage cart\n                this.storage.set('cart_pizza_app', null);\n\n                //Alert\n                let alert = this.alertCtrl.create({\n                  title: 'Obrigado',\n                  subTitle: 'Seu pedido j√° foi encaminhado!',\n                  buttons: ['Voltar']\n                });\n                alert.present();\n              })\n          }\n        }\n      ]\n    });\n    prompt.present();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/cart/cart.ts"],"sourceRoot":""}